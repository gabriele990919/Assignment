<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<title>PVM Sąskaitų sąrašas</title>
<style>
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  button { margin-right: 5px; }
</style>
</head>
<body>

<h1>PVM Sąskaitų sąrašas</h1>
<button onclick="window.location='invoice.html'">Sukurti naują sąskaitą</button>

<table id="invoiceTable">
  <thead>
    <tr>
      <th>Numeris</th>
      <th>Data</th>
      <th>Galutinė suma</th>
      <th>Veiksmai</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
function loadInvoices() {
  const invoices = JSON.parse(localStorage.getItem('invoices') || '[]');
  const tbody = document.querySelector('#invoiceTable tbody');
  tbody.innerHTML = '';

  invoices.forEach(inv => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${inv.number}</td>
      <td>${inv.date}</td>
      <td>${(inv.total ?? 0).toFixed(2)} €</td>
      <td>
        <button onclick="viewInvoice('${inv.id}')">Žiūrėti</button>
        <button onclick="editInvoice('${inv.id}')">Redaguoti</button>
        <button onclick="deleteInvoice('${inv.id}')">Trinti</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function viewInvoice(id) { window.location = `invoice.html?id=${id}&view=true`; }
function editInvoice(id) { window.location = `invoice.html?id=${id}`; }
function deleteInvoice(id) {
  if (!confirm('Ar tikrai norite ištrinti sąskaitą?')) return;
  let invoices = JSON.parse(localStorage.getItem('invoices') || '[]');
  invoices = invoices.filter(inv => inv.id !== id);
  localStorage.setItem('invoices', JSON.stringify(invoices));
  loadInvoices();
}

loadInvoices();
</script>

</body>
</html>
